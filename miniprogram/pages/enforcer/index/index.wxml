<!-- miniprogram/pages/enforcer/index/index.wxml -->
<view class="container">
  <view class="search-bar">
    <icon type="search" size="18" color="#64748b"></icon>
    <input placeholder="æœç´¢ä¼ä¸šåç§°" bindinput="onSearchInput" value="{{searchKeyword}}" confirm-type="search" bindconfirm="searchCompany"/>
    <view class="search-btn" bindtap="searchCompany">æœç´¢</view>
  </view>

  <view class="stats-row">
    <view class="stat-card" bindtap="navigateToCompanies">
      <text class="stat-number">{{stats.company_count}}</text>
      <text class="stat-label">ä¼ä¸šæ€»æ•°</text>
    </view>
    <view class="stat-card" bindtap="navigateToInspections">
      <text class="stat-number">{{stats.pending_count}}</text>
      <text class="stat-label">å¾…æ£€æŸ¥</text>
    </view>
    <view class="stat-card" bindtap="navigateToCompleted">
      <text class="stat-number">{{stats.completed_count}}</text>
      <text class="stat-label">å·²å®Œæˆ</text>
    </view>
  </view>

  <view class="section-title">å¾…æ£€æŸ¥ä¼ä¸š</view>
  <view class="company-list" wx:if="{{pendingInspections.length > 0}}">
    <view class="company-item" wx:for="{{pendingInspections}}" wx:key="id" bindtap="navigateToInspection" data-id="{{item.id}}">
      <view class="company-info">
        <view class="company-name">{{item.company_name}}</view>
        <view class="company-address">{{item.company_address}}</view>
        <view class="inspection-time">
          <text>è®¡åˆ’æ£€æŸ¥: {{item.planned_date}}</text>
        </view>
      </view>
      <view class="action-btn-container">
        <button class="action-btn" catchtap="navigateToInspection" data-id="{{item.id}}">æ‰§è¡Œæ£€æŸ¥</button>
      </view>
    </view>
  </view>
  <view class="empty-tip" wx:else>
    <view class="empty-icon">ğŸ“‹</view>
    <view class="empty-text">æš‚æ— å¾…æ£€æŸ¥ä¼ä¸š</view>
    <view class="empty-action" bindtap="showCompanySelector">åˆ›å»ºæ£€æŸ¥ä»»åŠ¡</view>
  </view>

  <view class="section-title">ä¼ä¸šåˆ—è¡¨</view>
  <view class="company-list" wx:if="{{companies.length > 0}}">
    <view class="company-item" wx:for="{{companies}}" wx:key="id" data-id="{{item.id}}">
      <view class="company-info">
        <view class="company-name">{{item.company_name}}</view>
        <view class="company-address">{{item.company_address}}</view>
        <view class="industry-badge">{{item.industry}}</view>
      </view>
      <view class="action-btn-container">
        <button class="action-btn" catchtap="selectCompany" data-id="{{item.id}}">å‘èµ·æ£€æŸ¥</button>
      </view>
    </view>
  </view>
  <view class="empty-tip" wx:else>
    <view class="empty-icon">ğŸ¢</view>
    <view class="empty-text">æš‚æ— åŒ¹é…ä¼ä¸š</view>
  </view>
  
  <view class="load-more" wx:if="{{hasMoreCompanies}}" bindtap="loadMoreCompanies">åŠ è½½æ›´å¤š</view>

  <view class="fab-button" bindtap="showCompanySelector">
    <text class="fab-icon">+</text>
  </view>
</view>